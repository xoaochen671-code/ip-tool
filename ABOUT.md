# IPQ - 项目定位与功能说明

## 📌 项目定位

**IPQ** 是一个轻量级、现代化的命令行 IP 查询工具，专注于为开发者和运维人员提供快速、直观的 IP 地址和域名信息查询体验。

### 目标用户

- 🧑‍💻 **开发者**: 快速查看本地公网 IP、调试网络问题
- 🔧 **运维工程师**: 批量查询 IP 地址信息、验证网络配置
- 🌐 **网络工程师**: 排查网络问题、验证 DNS 解析
- 📚 **学习者**: 了解网络基础知识、学习 Go 语言 TUI 开发

### 核心价值

1. **快速**: 单一命令即可获取所需信息，无需打开浏览器
2. **直观**: 美观的 TUI 界面，信息展示清晰
3. **便捷**: 一键复制功能，提高工作效率
4. **专业**: 提供地理位置、ISP、网络类型等详细信息

---

## ✨ 当前功能

### 1. 公网 IP 查询
- 自动检测并显示 IPv4 和 IPv6 地址
- 无需访问第三方网站
- 支持同时显示双栈信息

### 2. IP 地址查询
- 查询任意 IP 地址的详细信息
- 支持 IPv4 和 IPv6
- 提供地理位置定位

### 3. 域名解析
- 解析域名到 IP 地址
- 同时显示 A 记录（IPv4）和 AAAA 记录（IPv6）
- 自动识别输入类型（IP 或域名）

### 4. 地理位置信息（详细模式）
- **地理位置**: 国家、省份/地区、城市
- **ISP 信息**: 互联网服务提供商名称
- **网络属性**:
  - 是否为移动网络
  - 是否通过代理/VPN
  - 是否为数据中心 IP

### 5. 交互式 TUI
- 实时加载动画
- 友好的信息展示
- 快捷键操作：
  - `4` - 复制 IPv4 到剪贴板
  - `6` - 复制 IPv6 到剪贴板
  - `q` - 退出程序

---

## 🏗️ 技术架构

### 架构特点

```
┌─────────────────────────────────────────┐
│           CLI Layer (Cobra)             │
│  - 命令行参数解析                        │
│  - 用户输入验证                          │
└─────────────┬───────────────────────────┘
              │
┌─────────────▼───────────────────────────┐
│        TUI Layer (Bubble Tea)           │
│  - 交互式界面                            │
│  - 实时状态更新                          │
│  - 键盘事件处理                          │
└─────────────┬───────────────────────────┘
              │
┌─────────────▼───────────────────────────┐
│       Business Logic Layer              │
│  - IP 查询（icanhazip.com）             │
│  - DNS 解析（系统 DNS）                  │
│  - 地理信息查询（ip-api.com）           │
└─────────────────────────────────────────┘
```

### 技术栈

- **CLI 框架**: Cobra - 业界标准的 Go CLI 框架
- **TUI 框架**: Bubble Tea - Elm 架构的现代终端 UI 框架
- **工具库**: 
  - Bubbles - TUI 组件库（spinner）
  - clipboard - 跨平台剪贴板支持

### 代码组织

```
internal/
├── scanner/     # 数据获取层
│   └── client.go   - IP 查询、DNS 解析、地理信息
└── tui/         # 展示层
    └── model.go    - TUI 状态管理和渲染

cmd/
└── root.go      # 命令定义层
```

---

## ✅ 优点分析

### 1. 用户体验优秀

**现代化交互**
- 实时加载动画，用户体验流畅
- 信息分层展示，易于阅读
- 快捷键设计合理，操作便捷

**智能识别**
- 自动区分 IP 和域名
- 自动区分 IPv4 和 IPv6
- 无需记忆复杂参数

### 2. 架构设计合理

**清晰的分层**
- UI 层与业务逻辑分离
- 模块化设计，易于扩展
- 符合 Go 项目最佳实践

**良好的可维护性**
- 代码结构清晰
- 使用成熟的第三方库
- 遵循 Bubble Tea 的 Elm 架构模式

### 3. 技术选型优秀

**Cobra + Bubble Tea 组合**
- Cobra: kubectl、hugo 等知名项目都在使用
- Bubble Tea: 活跃维护，社区支持好
- 都是 Go 生态的一线库

**跨平台支持**
- 纯 Go 实现，天然跨平台
- Windows/Linux/macOS 都能运行
- 无外部依赖

### 4. 性能良好

**并发查询**
- IPv4 和 IPv6 并行获取
- TUI 异步更新，不阻塞
- 响应速度快

**资源占用低**
- 单一二进制文件
- 内存占用小
- 启动速度快

### 5. 开发友好

**代码质量**
- 使用现代 Go 特性
- 错误处理规范
- 代码可读性好

**扩展性强**
- 易于添加新命令
- 易于添加新的数据源
- TUI 组件可复用

---

## ⚠️ 缺点与不足

### 1. 功能相对单一

**当前问题**
- 仅支持基础的 IP 查询
- 缺少网络诊断功能（ping、traceroute、端口扫描）
- 没有批量查询能力
- 不支持历史记录

**影响**
- 无法满足高级用户需求
- 与专业网络工具相比功能较少

**改进方向**
- 添加网络诊断模块
- 支持批量查询和导出
- 添加历史记录功能

### 2. 错误处理不够完善

**当前问题**
- 网络错误时提示不够友好
- 缺少重试机制
- 离线状态处理不够优雅
- API 失败时没有降级方案

**影响**
- 网络不稳定时体验差
- 缺少错误恢复能力

**改进方向**
- 添加详细的错误提示
- 实现自动重试机制
- 添加多个 API 源作为备份
- 优化离线模式体验

### 3. 配置能力不足

**当前问题**
- 没有配置文件支持
- 无法自定义超时时间
- 无法选择数据源
- 缺少个性化设置

**影响**
- 用户无法根据需求定制
- 特殊网络环境下适应性差

**改进方向**
- 添加配置文件支持（YAML/TOML）
- 提供命令行参数覆盖配置
- 支持自定义 API key

### 4. 缺少测试覆盖

**当前问题**
- 没有单元测试
- 没有集成测试
- 缺少 CI/CD 流程

**影响**
- 重构时风险较高
- 代码质量难以保证
- 跨平台兼容性未经充分验证

**改进方向**
- 添加核心模块的单元测试
- 实现端到端测试
- 配置 GitHub Actions

### 5. 文档有待完善

**当前问题**
- 缺少架构设计文档
- 没有贡献指南
- API 文档不足
- 缺少使用场景示例

**影响**
- 新手不易上手
- 社区贡献门槛高

**改进方向**
- 编写详细的开发文档
- 添加 CONTRIBUTING.md
- 提供更多使用示例和 GIF 演示

### 6. API 依赖单一

**当前问题**
- 仅依赖 ip-api.com
- 没有 API 备份方案
- 受限于第三方服务的可用性和速率限制

**影响**
- API 服务故障时程序不可用
- 高频使用可能触发限流

**改进方向**
- 添加多个 API 源（ipinfo.io, ipapi.co 等）
- 实现智能切换机制
- 添加本地缓存

### 7. 权限要求

**当前问题**
- 未来要添加 ping 等功能需要特殊权限
- 跨平台权限处理复杂

**潜在影响**
- 用户体验可能受影响
- 某些功能在不同平台表现不一致

**改进方向**
- 提供降级方案（TCP ping）
- 清晰的权限说明文档
- 自动检测权限并提示用户

---

## 🎯 竞品对比

### vs. curl ifconfig.me

| 特性 | IPQ | curl ifconfig.me |
|------|-----|------------------|
| 交互界面 | ✅ 美观的 TUI | ❌ 纯文本输出 |
| IPv6 支持 | ✅ 同时显示 | ⚠️ 需要额外命令 |
| 地理信息 | ✅ 详细信息 | ❌ 无 |
| 复制功能 | ✅ 快捷键 | ❌ 手动复制 |
| 依赖 | ✅ 独立工具 | ✅ 系统自带 |

### vs. ip-api.com 网页

| 特性 | IPQ | ip-api.com |
|------|-----|------------|
| 速度 | ✅ 命令行快速 | ⚠️ 需要打开浏览器 |
| 批量查询 | ❌ 暂不支持 | ✅ 支持 |
| 历史记录 | ❌ 暂不支持 | ✅ 浏览器历史 |
| 离线使用 | ⚠️ 需要网络 | ❌ 必须在线 |
| 隐私性 | ✅ 本地运行 | ⚠️ 网页追踪 |

### vs. 传统网络工具（ping, traceroute）

| 特性 | IPQ | 系统工具 |
|------|-----|----------|
| IP 查询 | ✅ 核心功能 | ❌ 无 |
| 网络诊断 | ❌ 待添加 | ✅ 专业 |
| 易用性 | ✅ 现代 UI | ⚠️ 命令行参数多 |
| 跨平台 | ✅ 一致体验 | ⚠️ 参数不统一 |

---

## 📊 适用场景

### ✅ 适合的场景

1. **快速查看本机公网 IP**
   - 开发时需要确认出口 IP
   - 配置防火墙白名单
   - 测试 VPN 连接

2. **验证 DNS 解析**
   - 检查域名是否正确解析
   - 对比不同 DNS 的解析结果
   - 调试 CDN 配置

3. **查询 IP 归属信息**
   - 识别可疑 IP 来源
   - 分析访问日志中的 IP
   - 验证 CDN 节点位置

4. **日常开发使用**
   - 集成到开发脚本中
   - 快速获取网络信息
   - 替代频繁访问网页查询

### ❌ 不适合的场景

1. **专业网络诊断**
   - 复杂的路由追踪（待添加）
   - 深度端口扫描（待添加）
   - 网络性能测试

2. **大规模批量查询**
   - 目前不支持批量模式
   - 受第三方 API 速率限制

3. **企业级监控**
   - 缺少告警机制
   - 没有数据持久化
   - 不支持集成监控系统

4. **精确的地理定位**
   - IP 地理位置有一定误差
   - 不适合对精度要求极高的场景

---

## 🚀 未来规划

### 短期（1-2 个月）

- [ ] 添加基础网络诊断功能（ping、端口扫描）
- [ ] 支持配置文件
- [ ] 改进错误处理
- [ ] 添加单元测试

### 中期（3-6 个月）

- [ ] 实现批量查询
- [ ] 添加历史记录
- [ ] 支持结果导出（JSON/CSV）
- [ ] 多 API 源支持

### 长期（6 个月以上）

- [ ] 完整的网络诊断套件
- [ ] 插件系统
- [ ] Web Dashboard
- [ ] 企业版功能（监控、告警）

---

## 💡 总结

**IPQ** 是一个定位清晰、设计优秀的轻量级 IP 查询工具。它在用户体验和技术架构上都做得不错，特别适合开发者日常使用。

**核心优势**：
- 现代化的 TUI 交互体验
- 合理的架构设计和技术选型
- 良好的跨平台支持

**主要不足**：
- 功能相对单一，缺少高级特性
- 错误处理和配置能力有待加强
- 测试覆盖和文档需要完善

**发展方向**：
建议优先完善错误处理和配置系统，然后逐步添加网络诊断功能，最终发展成为一个功能全面的命令行网络工具集。

---

*最后更新: 2026-01-22*
